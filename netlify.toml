[build]
  publish = "."
  functions = "netlify/functions"

[functions]
  node_bundler = "esbuild"

# Security headers for all pages
[[headers]]
  for = "/*"
  [headers.values]
    # Prevent MIME type sniffing
    X-Content-Type-Options = "nosniff"
    # Prevent clickjacking
    X-Frame-Options = "DENY"
    # XSS protection (legacy browsers)
    X-XSS-Protection = "1; mode=block"
    # Referrer policy
    Referrer-Policy = "strict-origin-when-cross-origin"
    # Permissions policy - disable unnecessary features
    Permissions-Policy = "accelerometer=(), ambient-light-sensor=(), autoplay=(), battery=(), camera=(), cross-origin-isolated=(), display-capture=(), document-domain=(), encrypted-media=(), execution-while-not-rendered=(), execution-while-out-of-viewport=(), fullscreen=(), geolocation=(), gyroscope=(), keyboard-map=(), magnetometer=(), microphone=(), midi=(), navigation-override=(), payment=(), picture-in-picture=(), publickey-credentials-get=(), screen-wake-lock=(), sync-xhr=(), usb=(), web-share=(), xr-spatial-tracking=()"
    # Enable HSTS (HTTP Strict Transport Security)
    Strict-Transport-Security = "max-age=31536000; includeSubDomains; preload"
    # Cross-Origin policies for additional isolation
    Cross-Origin-Opener-Policy = "same-origin"
    Cross-Origin-Resource-Policy = "same-origin"

# Specific headers for API endpoints
[[headers]]
  for = "/api/*"
  [headers.values]
    X-Content-Type-Options = "nosniff"
    X-Frame-Options = "DENY"
    Cache-Control = "no-store, no-cache, must-revalidate"
    Pragma = "no-cache"

# Cache control for static assets
[[headers]]
  for = "/assets/*"
  [headers.values]
    Cache-Control = "public, max-age=31536000, immutable"

[[headers]]
  for = "/css/*"
  [headers.values]
    Cache-Control = "public, max-age=604800"

[[headers]]
  for = "/js/*"
  [headers.values]
    Cache-Control = "public, max-age=604800"

# Redirect HTTP to HTTPS (Netlify handles this automatically, but explicit is better)
[[redirects]]
  from = "http://cybersecelite.com/*"
  to = "https://cybersecelite.com/:splat"
  status = 301
  force = true

[[redirects]]
  from = "http://www.cybersecelite.com/*"
  to = "https://cybersecelite.com/:splat"
  status = 301
  force = true

[[redirects]]
  from = "https://www.cybersecelite.com/*"
  to = "https://cybersecelite.com/:splat"
  status = 301
  force = true

# Protect sensitive files
[[redirects]]
  from = "/.env"
  to = "/404.html"
  status = 404

[[redirects]]
  from = "/.git/*"
  to = "/404.html"
  status = 404

[[redirects]]
  from = "/package.json"
  to = "/404.html"
  status = 404

[[redirects]]
  from = "/package-lock.json"
  to = "/404.html"
  status = 404

[[redirects]]
  from = "/netlify.toml"
  to = "/404.html"
  status = 404

[[redirects]]
  from = "/scripts/*"
  to = "/404.html"
  status = 404
